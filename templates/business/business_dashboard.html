{% extends "base.html" %}
{% load static %}

{% block content %}

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Poppins', sans-serif;
    }

    .page-wrapper {
        min-height: 100vh;
        background-image:url("{% static 'assets/bg.jpg' %}");
        background-size: cover;
        background-position: center;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
    }

    .card {
        width: 100%;
        max-width: 560px;
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(18px);
        border-radius: 26px;
        padding: 28px;
        box-shadow: 0 30px 60px rgba(0, 0, 0, .35);
        border: 1px solid rgba(255, 255, 255, .35);
        animation: fadeUp .7s ease;
    }

    @keyframes fadeUp {
        from {
            opacity: 0;
            transform: translateY(30px)
        }

        to {
            opacity: 1;
            transform: translateY(0)
        }
    }

    h2 {
        color: #5eead4;
        font-size: 1.6rem;
        margin-bottom: 10px;
    }

    .badges {
        display: flex;
        gap: 8px;
        margin-bottom: 14px;
        flex-wrap: wrap;
    }

    .badge {
        font-size: .7rem;
        padding: 6px 14px;
        border-radius: 999px;
        font-weight: 600;
    }

    .verified {
        background: #1da1f2;
        color: #fff
    }

    .approved {
        background: #22c55e;
        color: #fff
    }

    .pending {
        background: #f59e0b;
        color: #fff
    }

    .info p {
        font-size: .85rem;
        margin-top: 8px;
        color: rgba(255, 255, 255, .85);
    }

    iframe {
        width: 100%;
        height: 240px;
        border-radius: 16px;
        border: none;
        margin: 18px 0;
    }

    .rating {
        margin-top: 10px;
        color: #fff;
        font-size: .9rem;
    }

    /* ===== REVIEWS ===== */
    .reviews {
        margin-top: 18px;
    }

    .review-card {
        background: rgba(255, 255, 255, .85);
        border-radius: 14px;
        padding: 12px 14px;
        margin-top: 10px;
    }

    .review-user {
        font-size: .8rem;
        font-weight: 600;
        color: #0f172a;
    }

    .review-stars {
        color: #facc15;
        font-size: .85rem;
    }

    .btn {
        width: 100%;
        margin-top: 14px;
        padding: 14px;
        border: none;
        border-radius: 16px;
        background: linear-gradient(135deg, #ff8a00, #ffb347);
        color: #fff;
        font-weight: 600;
        text-decoration: none;
        display: block;
        text-align: center;
        transition: .3s;
    }

    .secondary {
        background: linear-gradient(135deg, #64748b, #475569);
    }
</style>

<div class="page-wrapper">
    <div class="card">

        <h2>{{ business.business_name }}</h2>

        <div class="badges">
            <span class="badge verified">‚úî Verified</span>
            {% if business.is_approved %}
            <span class="badge approved">Approved</span>
            {% else %}
            <span class="badge pending">Pending Approval</span>
            {% endif %}
        </div>

        <div class="info">
            <p><strong>üìç Address:</strong> {{ business.address }}</p>
            <p><strong>‚è∞ Timings:</strong>
                {% if business.open_24_hours %}
                Open 24 Hours
                {% else %}
                {{ business.open_time }} ‚Äì {{ business.close_time }}
                {% endif %}
            </p>
            <p><strong>üìÜ Working Days:</strong> {{ business.working_days|join:", " }}</p>
            <p><strong>üìû Phone:</strong> {{ business.phone }}</p>
            <p><strong>üè∑ Category:</strong> {{ business.category }}</p>
        </div>

        <iframe
            src="https://www.google.com/maps?q={{ business.latitude }},{{ business.longitude }}&z=15&output=embed"></iframe>

        <div class="rating">
            ‚≠ê <strong>{{ avg_rating }}</strong> / 5
            ({{ total_ratings }} reviews)
        </div>

        <!-- üî• REVIEWS LIST -->
        <div class="reviews">
            <h3 style="color:#5eead4;margin-top:12px;font-size:1rem;">Customer Reviews</h3>

            {% if reviews %}
            {% for r in reviews %}
            <div class="review-card">
                <div class="review-user">{{ r.user.username }}</div>
                <div class="review-stars">
                    {% for i in "12345"|slice:":r.rating" %}‚òÖ{% endfor %}
                </div>
            </div>
            {% endfor %}
            {% else %}
            <p style="color:#cbd5f5;font-size:.85rem;margin-top:8px;">
                No reviews yet.
            </p>
            {% endif %}
        </div>

        <a href="{% url 'edit_business' %}" class="btn">‚úèÔ∏è Edit Business</a>
        <a href="{% url 'services' %}" class="btn secondary">‚¨Ö Back to Home</a>

    </div>
</div>

{% endblock %}